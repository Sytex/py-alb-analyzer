import pytest
from .albparser import parse_log_entry


@pytest.fixture
def alb_logs():
    return [
        'h2 2023-07-27T19:40:00.861031Z app/sytex-prod-blue/98f40b5a11a1e86b 170.51.250.38:12670 10.2.55.234:30036 0.000 0.067 0.000 200 200 5204 541 "GET https://claro.sytex.io:443/api/announcement/ HTTP/2.0" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Edg/115.0.1901.183" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c810-162a9bf355d916366b47081e" "claro.sytex.io" "session-reused" 0 2023-07-27T19:40:00.793000Z "forward" "-" "-" "10.2.55.234:30036" "200" "-" "-"',
        'h2 2023-07-27T19:40:00.986529Z app/sytex-prod-blue/98f40b5a11a1e86b 170.51.250.36:30750 10.2.70.190:30036 0.000 2.103 0.000 200 200 5218 793 "GET https://claro.sytex.io:443/api/dashboard/31/card/ HTTP/2.0" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c80e-7f57f68122e98e2036db494a" "claro.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:39:58.883000Z "forward" "-" "-" "10.2.70.190:30036" "200" "-" "-"',
        'h2 2023-07-27T19:40:01.082724Z app/sytex-prod-blue/98f40b5a11a1e86b 191.95.33.50:52251 10.2.52.63:30036 0.000 0.077 0.000 401 401 169 537 "POST https://app.sytex.io:443/api/tracking/ HTTP/2.0" "okhttp/5.0.0-alpha.11" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-5bfeee250634a14f65be6d7f" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.005000Z "forward" "-" "-" "10.2.52.63:30036" "401" "-" "-"',
        'https 2023-07-27T19:40:01.085061Z app/sytex-prod-blue/98f40b5a11a1e86b 191.156.42.64:36850 10.2.75.72:30036 0.000 0.086 0.000 200 200 1329 1472 "GET https://app.sytex.io:443/api/user/login_info/ HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c810-2650fcc000f43feb5fc26eb3" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:00.999000Z "forward" "-" "-" "10.2.75.72:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.142528Z app/sytex-prod-blue/98f40b5a11a1e86b 152.202.223.174:42974 10.2.55.234:30036 0.000 0.298 0.000 200 200 1625 1223 "PATCH https://app.sytex.io:443/api/urformanswer/63405d78-df0d-4225-879c-3348b51d6c0f/ HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c810-74171e3f1303d53e1b2fa83a" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:00.844000Z "forward" "-" "-" "10.2.55.234:30036" "200" "-" "-"',
        'h2 2023-07-27T19:40:01.213748Z app/sytex-prod-blue/98f40b5a11a1e86b 170.51.250.36:30770 10.2.70.190:30036 0.000 0.323 0.000 200 200 5489 3053 "GET https://claro.sytex.io:443/api/referencedocumenttemplate/?q=&version=4781&work_structure_template=426 HTTP/2.0" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c810-005a7dcb4b419031642a12d5" "claro.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:00.889000Z "forward" "-" "-" "10.2.70.190:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.252032Z app/sytex-prod-blue/98f40b5a11a1e86b 186.169.150.116:58138 10.2.75.204:30036 0.000 0.134 0.000 200 200 1384 712 "GET https://app.sytex.io:443/api/answerfile/?entry_answer_form=1821825&last_sync__gt=1690486799409&limit=99999 HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-335ee26d7162c542053622ec" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.118000Z "forward" "-" "-" "10.2.75.204:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.262235Z app/sytex-prod-blue/98f40b5a11a1e86b 186.103.50.154:6324 10.2.60.208:30036 0.000 0.332 0.000 200 200 1368 6650 "GET https://app.sytex.io:443/api/urformanswer/?last_sync__gt=1690486780038&form=1821272 HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c810-3500d366766859651690e4a5" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:00.928000Z "forward" "-" "-" "10.2.60.208:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.262745Z app/sytex-prod-blue/98f40b5a11a1e86b 190.148.87.98:47463 10.2.67.129:30036 0.000 1.059 0.000 200 200 1361 27757 "GET https://app.sytex.io:443/api/urformanswer/?last_sync__gt=1690486714723&form=1403027 HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c810-2a24ec717057924902e84fea" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:00.198000Z "forward" "-" "-" "10.2.67.129:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.285700Z app/sytex-prod-blue/98f40b5a11a1e86b 186.102.73.44:22585 10.2.51.17:30036 0.000 0.358 0.000 200 200 1322 10337 "GET https://app.sytex.io:443/api/form/1821155/ HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c810-41ecea85615d1dff57c7b944" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:00.926000Z "forward" "-" "-" "10.2.51.17:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.291958Z app/sytex-prod-blue/98f40b5a11a1e86b 191.95.41.181:10723 10.2.64.138:30036 0.001 0.220 0.000 200 200 1366 661 "GET https://app.sytex.io:443/api/urformgroup/?last_sync__gt=1690485717088&form=1821732 HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-1b8e4fef1afb888f4dba4b07" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.070000Z "forward" "-" "-" "10.2.64.138:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.388876Z app/sytex-prod-blue/98f40b5a11a1e86b 3.86.2.189:46586 10.2.66.203:30036 0.000 0.200 0.000 200 200 451 1184 "PATCH https://app.sytex.io:443/api/urformanswer/83ea51b4-b663-4326-9705-cb2a3f6b87bd/ HTTP/1.1" "python-requests/2.28.0" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-1b9cd36517a79b7f7e29d5f0" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.189000Z "forward" "-" "-" "10.2.66.203:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.419573Z app/sytex-prod-blue/98f40b5a11a1e86b 3.91.204.110:36418 10.2.72.20:30036 0.000 0.154 0.000 200 200 497 1226 "PATCH https://app.sytex.io:443/api/urformanswer/836a8a91-7e4d-4314-b55e-16e57da3c43f/ HTTP/1.1" "python-requests/2.28.0" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-719962e8697906d4627f9a97" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.264000Z "forward" "-" "-" "10.2.72.20:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.494549Z app/sytex-prod-blue/98f40b5a11a1e86b 191.156.33.4:36878 10.2.63.132:30036 0.000 0.092 0.000 200 200 1344 1639 "GET https://app.sytex.io:443/api/people/whoami/?organization=115 HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-27f2cfe41d277d5669c7c909" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.402000Z "forward" "-" "-" "10.2.63.132:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.549181Z app/sytex-prod-blue/98f40b5a11a1e86b 190.66.248.216:47466 10.2.67.129:30036 0.000 0.199 0.000 200 200 1390 712 "GET https://app.sytex.io:443/api/answerfile/?entry_answer_form=1821435&last_sync__gt=1690486799253&limit=99999 HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-7cd5efda0a5cddbf31d70ef8" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.350000Z "forward" "-" "-" "10.2.67.129:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.572835Z app/sytex-prod-blue/98f40b5a11a1e86b 186.169.150.116:58138 10.2.54.146:30036 0.000 0.212 0.000 200 200 1392 712 "GET https://app.sytex.io:443/api/file/?content_type__model=form&object_id=1821825&show_for_reference=1&last_sync__gt=0 HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-41b17de300d47f524515ad06" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.361000Z "forward" "-" "-" "10.2.54.146:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.595374Z app/sytex-prod-blue/98f40b5a11a1e86b 191.156.42.64:36850 10.2.52.43:30036 0.000 0.199 0.000 200 200 1398 712 "GET https://app.sytex.io:443/api/file/?content_type__model=form&object_id=1638053&show_for_reference=1&last_sync__gt=0 HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-6e111423582394854e5f008f" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.396000Z "forward" "-" "-" "10.2.52.43:30036" "200" "-" "-"',
        'https 2023-07-27T19:40:01.650954Z app/sytex-prod-blue/98f40b5a11a1e86b 186.103.50.154:6324 10.2.70.190:30036 0.000 0.158 0.000 200 200 1399 712 "GET https://app.sytex.io:443/api/file/?content_type__model=form&object_id=1821272&show_for_reference=1&last_sync__gt=0 HTTP/1.1" "Dart/2.19 (dart:io)" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-1:324513483688:targetgroup/sytex-prod-blue/3575b456123a9b7c "Root=1-64c2c811-3a6803d12447e521682bf5cf" "app.sytex.io" "arn:aws:acm:us-east-1:324513483688:certificate/c5880614-be91-4aa4-accc-8d6dda5c2d76" 0 2023-07-27T19:40:01.493000Z "forward" "-" "-" "10.2.70.190:30036" "200" "-" "-"',
    ]


def test_alb_log_parser(alb_logs):
    for log in alb_logs:
        log_entry = parse_log_entry(log)
        print(log_entry)
